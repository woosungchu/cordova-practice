<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <title>Notification Example</title>
    <script type="text/javascript" charset="utf-8" src="../cordova.js"></script>
    <script type="text/javascript" charset="utf-8">
        document.addEventListener("deviceready", onDeviceReady, false);

        function onDeviceReady() {
            console.log("device is ready");
            initFCM();
            getToken();
        }

        function initFCM() {
        	 FCMPlugin.onTokenRefresh(function(token){
        	 	pushtoken = token;
        	 	console.log('onTokenRefresh:'+ token);
        	 }, function(err){
        	 	console.log('error retrieving token: ' + err);
        	 });
        	 FCMPlugin.onNotification(function(data){
        	 	if(data.wasTapped){
        	 		console.log(JSON.stringify(data));
        	 	}else{
        	 		console.log(JSON.stringify(data));
        	 	}
        	 }, function(msg){
        	 	console.log('onNotification callback successfully registered: ' + msg);
        	 }, function(err){
        	 	console.log('Error registering onNotification callback: ' + err);
        	 });
        }
        function getToken() {
        	 FCMPlugin.getToken(function(token){
        	 	pushtoken = token;
        	 	console.log('getToken:', token);
        	 	if (!token) setTimeout(getToken, 1000);
        	 }, function(err){
        	 	console.log('error retrieving token: ' + err);
        	 });
        }
    </script>
</head>

<div id="home">
    <div id="app-status-div">
        <ul id="app-status-ul">
            <li>Cordova PushNotification Plugin Demo</li>
        </ul>
    </div>
</div>
